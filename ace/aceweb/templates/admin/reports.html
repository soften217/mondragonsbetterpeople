
<head>
	<title>ACE Program | Reports </title>

	<link rel="stylesheet" type="text/css" href="css/admin/report.css">
</head>

<body>

<div>

	<div class="input-group">

					<div class="input-group-btn search-panel">
							<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
									<span id="search_concept">Search by</span>
									<span class="caret"></span>
							</button>
							<ul class="dropdown-menu" role="menu">
									<li><a href="javascript:void(0)" ng-click="changeFilterTo('sender_fullName')">Name</a></li>
									<li><a href="javascript:void(0)" ng-click="changeFilterTo('message_subject')">Subject</a></li>
							</ul>
					</div>

					<input type="text" class="form-control" ng-model="searchBox[myFilter]" placeholder="{{searchPlacholder}}">

		</div>

		<div class="dropdown">

			<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
		    	Select
		    	<span class="caret"></span>
			</button>
		</div>

		<div class="dropdown">

		  	<button class="btn btn-default dropdown-toggle" type="button" ng-disabled="disableActionBtn()" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
		    	Action
		    	<span class="caret"></span>
		  	</button>

		  	<ul class="dropdown-menu" aria-labelledby="dropdownMenu2">

					<li><a href="javascript:void(0)" ng-click="markAsRead()">Mark as read</a></li>
		    	<li><a href="javascript:void(0)" ng-click="markAsUnread()">Mark as unread</a></li>

					<li><a href="javascript:void(0)" ng-click="deleteReportList()">Delete</a></li>
		  	</ul>

		</div>

		<button class="btn btn-default" type="button" ng-click="initScope()">
		    Refresh
		</button>

		<table class="table table-bordered table-condensed table-striped table-condensed table-hover">
			<col width="130">
			<col width="200">
				<tbody>
						<tr>
							<th><center><input type="checkbox" ng-model="mainCheckbox" ng-change="controlCheckbox()"></center></th>
							<th>Date</th>
							<th>Subject</th>
							<th>Reported by</th>
							<th>Student ID: </th>
							<th>Name </th>
							<th>Course</th>
							<th>Status</th>
							<th>Action/s</th>

						</tr>
						<!--    -->
						<tr ng-repeat="report in reports | startFrom:(currentPage-1)*itemsPerPage | limitTo:itemsPerPage" data-toggle="modal" data-target="#viewModal" ng-click="viewReport(report)" ng-class="report.is_read == 1 ? 'info' : 'success'">
							<td>
								<center><input type="checkbox" data-checklist-model="reportList.report_id" data-checklist-value="report.report_id" checklist-change="updateMainCheckbox()" noclick></center>
							</td>
							<td>
								{{ report.report_date | date: "fullDate"}}
							</td>
							<td>
								{{ report.subject_name }}
							</td>
							<td>
								{{ report.sender_fullName }}
							</td>
							<td>
								{{ report.student_id }}
							</td>
							<td>
								{{ report.first_name }} {{ report.last_name }}
							</td>
							<td>
								{{ report.program }}
							</td>
							<td>
								{{ report.report_status_id }}
							</td>
							<td>
								<!--
								<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#viewModal" ng-click="viewReport(report)">View</button>
								-->
								<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#messageModal" ng-click="createMessage(report)" noclick>Message</button>
								<!--
								<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#noteModal" ng-click="showPopup(report)">Edit</button>
								-->
								<button type="button" class="btn btn-primary" ng-click="deleteReport(report.report_id)" noclick><span class="glyphicon glyphicon-trash"></span></button>

								<!---
								<div class="btn-group">
  								<a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
    								<span class="fa fa-ellipsis-h" aria-hidden="true" title="Toggle dropdown menu"></span>
  								</a>
  								<ul class="dropdown-menu">
    								<li><i class="fa fa-pencil fa-fw"></i>Edit</li>
    								<li><i class="fa fa-trash-o fa-fw"></i> Delete</a></li>
    								<li><a href="#"><i class="fa fa-ban fa-fw"></i> Ban</a></li>
  								</ul>
								</div>

								-->

							</td>
						</tr>
				</tbody>
			</table>

			<div ng-show="reports.length == 0">
				<p>No Result</p>
			</div>

			<div>
				<ul uib-pagination total-items="totalItems" ng-model="currentPage" items-per-page="itemsPerPage" max-size="maxSize" class="pagination-sm" boundary-links="true"></ul>
			</div>

<!-- MODALS ------------------------------------------------------------------->

		<!---   MESSAGE MODAL  ---------------------------------------------------->

			<div id="messageModal" class="modal draggable" role="dialog">
					<div class="modal-dialog">

						<div class="modal-content">
								<div class="modal-header">
									<!--
									<button type="button" class="close" data-dismiss="modal"><span class="glyphicon glyphicon-remove custom-header-color" aria-hidden="true"></span></button>
									-->
									<h4 class="modal-title custom-header-color">Report #  {{ selectedReport.report_id }}</h4>
								</div>

								<div class="modal-body">

									<p>
										Student ID Number: {{selectedReport.student_id}} <br>
										Reported by: {{ selectedReport.email}}<br>

									</p>
									<br/>
										<textarea id="customTextArea" style="overflow:auto;resize:none" rows="30" cols="20" rows="4" ng-model="composeEmail" ></textarea>
								</div>

								<div class="modal-footer">
										<button type="button" class="btn btn-primary" ng-click="sendEmail(selectedReport.email, selectedReport.report_id, selectedReport.student_id, selectedReport.subject_name)">Reply</button>
										<button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
								</div>
						</div>

					</div>
			</div><!-- modal closing tag -->

			<!---   VIEW REPORT  --------------------------------------------------->

				<div id="viewModal" class="modal fade" role="dialog">
						<div class="modal-dialog">

							<div class="modal-content">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal"><span class="glyphicon glyphicon-remove custom-header-color" aria-hidden="true"></span></button>
										<h4 class="modal-title custom-header-color">ACE Report</h4>
								</div>
									<div class="modal-body">

											<p><b>Date: </b> {{ selectedReport.report_date | date: "fullDate"}}
											<p><b>Student ID Number: </b> {{ selectedReport.student_id }}
											<p><b>Year Level: </b> {{ selectedReport.level }}
											<p><b>Subject: </b> {{ selectedReport.subject_name}}
											<p><b>Name: </b> {{ selectedReport.first_name }} {{ selectedReport.last_name}}
											<p><b>Status </b> {{ selectedReport.report_status_id }}
											<p><b>Referred by: </b> {{ selectedReport.sender_fullName}}
											<p><b>Course: </b> {{ selectedReport.program }}
											<p><b>Counselor's Note </b> {{ selectedReport.counselor_note }}
											<hr>
												<p><b>
											<hr>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#noteModal" ng-click="showPopup(selectedReport)" data-dismiss="modal">Edit</button>
										<!--<a href="#noteModal" class="btn btn-primary" data-toggle="modal" data-dismiss="modal">Edit</a>-->
										<button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
									</div>
							</div>

						</div>
				</div><!-- modal closing tag -->

				<!---  COUNSELOR NOTES  ----------------------------------------------->

					<div id="noteModal" class="modal fade" role="dialog">
							<div class="modal-dialog">

								<div class="modal-content">
										<div class="modal-header">
											<button type="button" class="close" data-dismiss="modal"><span class="glyphicon glyphicon-remove custom-header-color" aria-hidden="true"></span></button>
											<h4 class="modal-title custom-header-color">Edit</h4>
									</div>
										<div class="modal-body">
											<p><b>Report Status</b></p>
											<select class="form-control" name="status" id="status" ng-model="status" required>

											<option ng-selected="status == item.value" ng-repeat="item in reportStatus" ng-value="item.value">{{item.text}}</option>

											</select>

											<select ng-model="status" ng-options="house.house_id as house.house_display_name for house in house_list">
											</select>

											<p><b>Counselor's Note</b></p>
											<textarea id="customTextArea" rows="4" ng-model="comment">N/A</textarea>
										</div>
										<div class="modal-footer">
											<button type="button" class="btn btn-primary" ng-click="updateReportStatus(selectedReport)">Update</button>
										</div>
								</div>

							</div>
					</div><!-- modal closing tag -->


</div>

</body>
